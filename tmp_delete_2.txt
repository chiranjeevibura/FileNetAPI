SELECT PROD_ACCT_NO, STATC_CLOSED_MAINT_DT, PROD_CD, STATC_LEGAL_CD, CCL_BAL_AM, STMT_CUR_BAL_AM
FROM (
    SELECT PROD_ACCT_NO, STATC_CLOSED_MAINT_DT, PROD_CD, STATC_LEGAL_CD, CCL_BAL_AM, STMT_CUR_BAL_AM,
           ROW_NUMBER() OVER (
               PARTITION BY PROD_ACCT_NO 
               ORDER BY STATC_CLOSED_MAINT_DT DESC
           ) AS row_num
    FROM TERADATA_TABLE_2
    WHERE PROD_CD = 'CC' 
      AND STATC_LEGAL_CD IS NOT NULL 
      AND CCL_BAL_AM = 0 
      AND STMT_CUR_BAL_AM = 0 
      AND STATC_CLOSED_MAINT_DT <> '0001-01-01'
) t
WHERE row_num = 1;
